define ("tool_componentlibrary/checkcontrast",["jquery","core/log"],function(a,b){var c={errors:[],warnings:[]},d={parseRgb:function parseRgb(a){var b,c,d,e,f;c=a.match(/rgb\(\s*(\-?\d+),\s*(\-?\d+)\s*,\s*(\-?\d+)\s*\)/);if(c){d=c.slice(1,4);for(b=e=0;2>=e;b=++e){d[b]=+d[b]}d[3]=1}else{c=a.match(/rgba\(\s*(\-?\d+),\s*(\-?\d+)\s*,\s*(\-?\d+)\s*,\s*([01]|[01]?\.\d+)\)/);if(c){d=c.slice(1,5);for(b=f=0;3>=f;b=++f){d[b]=+d[b]}}}return d},contrastRatio:function contrastRatio(a,b){var c=d.relativeLuminance(d.parseRgb(a)),e=d.relativeLuminance(d.parseRgb(b));return(Math.max(c,e)+.05)/(Math.min(c,e)+.05)},relativeLuminance:function relativeLuminance(a){for(var b=[],c=0,d;3>c;c++){d=a[c]/255;b.push(.03928>d?d/12.92:Math.pow((d+.055)/1.055,2.4))}return .2126*b[0]+.7152*b[1]+.0722*b[2]},getBackground:function getBackground(a){var b=getComputedStyle(a),c=b.backgroundColor,e=b.backgroundImage;if("rgba(0, 0, 0, 0)"!==c&&"transparent"!==c&&"none"===e){return c}else if("none"!==e){return"image"}if("HTML"===a.tagName){return"rgb(255, 255, 255)"}else{return d.getBackground(a.parentNode)}},isVisible:function isVisible(a){return!!(a.offsetWidth||a.offsetHeight||a.getClientRects().length)},check:function check(e){for(var f=e.querySelectorAll("*"),g=0;g<f.length;g++){(function(e){var g=f[e],h=a(g);b.debug(h);if(d.isVisible(g)){var i=getComputedStyle(g),j=i.color,k=i.fill,l=g.tagName,m=d.getBackground(g),n=[].reduce.call(g.childNodes,function(c,a){return c+(3===a.nodeType?a.textContent:"")},""),o=n.trim(),p,q,r;if("svg"===l){var s=Math.round(100*d.contrastRatio(k,m))/100,t=s+":1";if(3>s){r="true";q="svg fill";p="fail"}}else if(o.length){if("image"===m){p="Needs manual review";q="N/A";r=!0}else{var s=Math.round(100*d.contrastRatio(j,m))/100,t=s+":1",u=parseInt(i.fontSize),v=i.fontWeight;if(18<=u||14<=u&&700<=v){q="large scale text";if(3>s){p="fail";r=!0}else{p="pass";r=!1}}else{q="normal body text";if(4.5>s){p="fail";r=!0}else{p="pass";r=!1}}}}if(r){var w={};w={name:g,ratio:t,detail:q,status:p};if("fail"===p){c.errors.push(w)}else if("Needs manual review"===p){c.warnings.push(w)}}}})(g)}return c}};return{init:function init(){a("[data-action=\"contrastcheck\"]").each(function(){var b=a(this)[0];d.check(b);for(var e=0,f;e<c.errors.length;e++){f=c.errors[e];a(f.name).append("<span class=\"badge badge-danger border border-dark m-1\">"+f.ratio+"</span>")}for(var e=0,f;e<c.warnings.length;e++){f=c.warnings[e];a(f.name).append("<span class=\"badge badge-warning border border-dark m-1\">"+f.ratio+"</span>")}c.errors=[];c.warnings=[]})}}});
//# sourceMappingURL=checkcontrast.min.js.map

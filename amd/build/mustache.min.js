define ("tool_componentlibrary/mustache",["jquery","core/ajax","core/log","core/notification","core/templates","core/config","core/str"],function(a,b,c,d,e,f,g){var h=function(a,b){if(!a){return!1}var c="@template "+b,d=0,e=[];e=a.match(/{{!([\s\S]*?)}}/g);if(null!==e){for(d=0;d<e.length;d++){var f=e[d],g=f.indexOf(c);if(-1!==g){var h=g+c.length+1;f=f.substr(h,f.length-2-h);return f}}}return!1},i=function(a,b,f,i,j){a.find("[data-region=\"source\"]").text(f);if(!j){var k=h(f,b);if(!1===k){k=h(i,b)}if(!1===k){c.debug("Template is missing docs section.");return}var j=k.match(/Example context \(json\):([\s\S]*);?/);j=j[1].trim();a.find("[data-region=\"config\"]").text(j)}var l=!1;if(j){try{l=JSON.parse(j)}catch(a){c.debug("Could not parse json example context for template.");c.debug(a)}}if(l){e.render(b,l).done(function(b,c){e.replaceNodeContents(a.find("[data-region=\"rendered\"]"),b,c)}).fail(d.exception)}else{g.get_string("templatehasnoexample","tool_templatelibrary").done(function(b){a.find("[data-region=\"rendered\"]").text(b)}).fail(d.exception)}},j=function(c,e,g){var h=e.split("/"),j=h.shift(),k=h.join("/"),l=b.call([{methodname:"core_output_load_template",args:{component:j,template:k,themename:f.theme,includecomments:!0}},{methodname:"tool_templatelibrary_load_canonical_template",args:{component:j,template:k}}],!0,!1);a.when.apply(a,l,g).done(function(a,b){i(c,e,a,b,g)}).fail(d.exception)};return{init:function init(){var b=a("[data-region=\"componentlibrary\"]");b.find("[data-region=\"mustachecode\"]").each(function(){var b=a(this).attr("data-template");j(a(this),b)});b.find("[data-region=\"mustachewithcontext\"").each(function(){var b=a(this).attr("data-template"),c=a(this).attr("data-config");j(a(this),b,c)})}}});
//# sourceMappingURL=mustache.min.js.map

define ("tool_componentlibrary/mustache",["jquery","core/ajax","core/log","core/notification","core/templates","core/config","core/str"],function(a,b,c,d,e,f,g){var h=function(a,b){if(!a){return!1}var c="@template "+b,d=0,e=[];e=a.match(/{{!([\s\S]*?)}}/g);if(null!==e){for(d=0;d<e.length;d++){var f=e[d],g=f.indexOf(c);if(-1!==g){var h=g+c.length+1;f=f.substr(h,f.length-2-h);return f}}}return!1},i=function(b,f,i,j){g.get_string("templateselected","tool_templatelibrary",f).done(function(b){a("[data-region=\"displaytemplateheader\"]").text(b)}).fail(d.exception);var k=h(i,f);b.find("[data-region=\"source\"]").text(i);if(!1===k){k=h(j,f)}if(k){i=k}var l=i.match(/Example context \(json\):([\s\S]*);?/);b.find("[data-region=\"config\"]").text(l);var m=!1;if(l){var n=l[1].trim();try{m=a.parseJSON(n)}catch(a){c.debug("Could not parse json example context for template.");c.debug(a)}}if(m){e.render(f,m).done(function(a,c){e.replaceNodeContents(b.find("[data-region=\"rendered\"]"),a,c)}).fail(d.exception)}else{g.get_string("templatehasnoexample","tool_templatelibrary").done(function(a){b.find("[data-region=\"rendered\"]").text(a)}).fail(d.exception)}},j=function(c,e){var g=e.split("/"),h=g.shift(),j=g.join("/"),k=b.call([{methodname:"core_output_load_template",args:{component:h,template:j,themename:f.theme,includecomments:!0}},{methodname:"tool_templatelibrary_load_canonical_template",args:{component:h,template:j}}],!0,!1);a.when.apply(a,k).done(function(a,b){i(c,e,a,b)}).fail(d.exception)};return{init:function init(b,c){var b=a(b);j(b,c)}}});
//# sourceMappingURL=mustache.min.js.map
